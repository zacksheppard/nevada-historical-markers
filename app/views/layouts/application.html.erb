<!DOCTYPE html>
<html>
<head>
  <title>Nevada Historical Markers</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.css' rel='stylesheet' />
  <script>
    $(document).ready(function() {
      $.ajax({
        dataType: 'text',
        url: '/markers.json',
        success: function(data) {
          var geojson;
          geojson = $.parseJSON(data);
          return map.featureLayer.setGeoJSON(geojson);
        }
      });

      L.mapbox.accessToken = 'pk.eyJ1IjoiemFja3NocCIsImEiOiIzZ09nMDZZIn0.a_wcJpacq_Sojc5QO_4gww';
      var map = L.mapbox.map('map', 'zackshp.k0bb3ic6')
          .setView([39.606810, -116.929677], 8);

      map.featureLayer.on('layeradd', function(e) {
        var marker, popupContent, properties;
        marker = e.layer;
        properties = marker.feature.properties;
        popupContent = '<div class="popup">' + '<p>No. ' + properties.number + '</p>' + '<h3><a href="/markers/' + properties.id + '">' + properties.name + '</a></h3>' + '</div>';
        return marker.bindPopup(popupContent, {
          closeButton: false,
          minWidth: 300
        });
      });
    });


    
  </script>

  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= csrf_meta_tags %>
</head>
<body>
  <div class="navbar navbar-default">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="#">Nevada Historical Markers </a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav">
      <li><a href="/">Map</a></li>
      <li><a href="/markers">List</a></li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
    <form class="navbar-form navbar-left">
      <input type="text" class="form-control col-lg-8" placeholder="Search">
    </form>
      <li><a href="#">About</a></li>
    </ul>
  </div>
</div>

<%= yield %>

</body>
</html>
